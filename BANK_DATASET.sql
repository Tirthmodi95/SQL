CREATE DATABASE BANK;
USE BANK;
CREATE TABLE IF NOT EXISTS BANK_DETAILS(
AGE INT,
JOB VARCHAR(30),
MARITAL VARCHAR(30),
EDUCATION VARCHAR(30),
`DEFAULT` VARCHAR(30),
BALANCE INT,
HOUSING VARCHAR(30),
LOAN VARCHAR(30),
CONTACT VARCHAR(30),
`DAY` INT,
`MONTH` VARCHAR(30),
DURATION INT,
CAMPAIGN INT,
PDAYS INT,
PREVIOUS INT,
POUTCOME VARCHAR(30),
Y VARCHAR(30));
SELECT * FROM BANK_DETAILS;
SHOW TABLES;
INSERT INTO BANK_DETAILS VALUES(44,"TECHNICIAN","SINGLE","SECONDARY","NO",29,"YES","NO","UNKNOWN",5,"MAY",151,1,-1,0,"UNKNOWN","NO"),
(33,"ENTREPRENEUR","MARRIED","SECONDARY","NO",2,"YES","YES","UNKNOWN",5,"MAY",76,1,-1,0,"UNKNOWN","NO"),
(47,"BLUE-COLLAR","MARRIED","UNKNOWN","NO",1506,"YES","NO","UNKNOWN",5,"MAY",92,1,-1,0,"UNKNOWN","NO"),
(33,"UNKNOWN","SINGLE","UNKNOWN","NO",1,"NO","NO","UNKNOWN",5,"MAY",198,1,-1,0,"UNKNOWN","NO"),
(35,"MANAGEMENT","MARRIED","TERTIARY","NO",231,"YES","NO","UNKNOWN",5,"MAY",139,1,-1,0,"UNKNOWN","NO"),
(28,"MANAGEMENT","SINGLE","TERTIARY","NO",447,"YES","YES","UNKNOWN",5,"MAY",217,1,-1,0,"UNKNOWN","NO"),
(42,"ENTREPRENEUR","DIVORCED","TERTIARY","YES",2,"YES","NO","UNKNOWN",5,"MAY",380,1,-1,0,"UNKNOWN","NO"),
(58,"RETIRED","MARRIED","PRIMARY","NO",121,"YES","NO","UNKNOWN",5,"MAY",50,1,-1,0,"UNKNOWN","NO"),
(43,"TECHNICIAN","SINGLE","SECONDARY","NO",593,"YES","NO","UNKNOWN",5,"MAY",55,1,-1,0,"UNKNOWN","NO"),
(41,"ADMIN.","DIVORCED","SECONDARY","NO",270,"YES","NO","UNKNOWN",5,"MAY",222,1,-1,0,"UNKNOWN","NO"),
(29,"ADMIN.","SINGLE","SECONDARY","NO",390,"YES","NO","UNKNOWN",5,"MAY",137,1,-1,0,"UNKNOWN","NO"),
(53,"TECHNICIAN","MARRIED","SECONDARY","NO",6,"YES","NO","UNKNOWN",5,"MAY",517,1,-1,0,"UNKNOWN","NO"),
(58,"TECHNICIAN","MARRIED","UNKNOWN","NO",71,"YES","NO","UNKNOWN",5,"MAY",71,1,-1,0,"UNKNOWN","NO"),
(57,"SERVICES","MARRIED","SECONDARY","NO",162,"YES","NO","UNKNOWN",5,"MAY",174,1,-1,0,"UNKNOWN","NO"),
(51,"RETIRED","MARRIED","PRIMARY","NO",229,"YES","NO","UNKNOWN",5,"MAY",353,1,-1,0,"UNKNOWN","NO"),
(45,"ADMIN.","SINGLE","UNKNOWN","NO",13,"YES","NO","UNKNOWN",5,"MAY",98,1,-1,0,"UNKNOWN","NO"),
(57,"BLUE-COLLAR","MARRIED","PRIMARY","NO",52,"YES","NO","UNKNOWN",5,"MAY",38,1,-1,0,"UNKNOWN","NO"),
(60,"RETIRED","MARRIED","PRIMARY","NO",60,"YES","NO","UNKNOWN",5,"MAY",219,1,-1,0,"UNKNOWN","NO"),
(33,"SERVICES","MARRIED","SECONDARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",54,1,-1,0,"UNKNOWN","NO"),
(28,"BLUE-COLLAR","MARRIED","SECONDARY","NO",723,"YES","YES","UNKNOWN",5,"MAY",262,1,-1,0,"UNKNOWN","NO"),
(56,"MANAGEMENT","MARRIED","TERTIARY","NO",779,"YES","NO","UNKNOWN",5,"MAY",164,1,-1,0,"UNKNOWN","NO"),
(32,"BLUE-COLLAR","SINGLE","PRIMARY","NO",23,"YES","YES","UNKNOWN",5,"MAY",160,1,-1,0,"UNKNOWN","NO"),
(25,"SERVICES","MARRIED","SECONDARY","NO",50,"YES","NO","UNKNOWN",5,"MAY",342,1,-1,0,"UNKNOWN","NO"),
(40,"RETIRED","MARRIED","PRIMARY","NO",0,"YES","YES","UNKNOWN",5,"MAY",181,1,-1,0,"UNKNOWN","NO"),
(44,"ADMIN.","MARRIED","SECONDARY","NO",-372,"YES","NO","UNKNOWN",5,"MAY",172,1,-1,0,"UNKNOWN","NO"),
(39,"MANAGEMENT","SINGLE","TERTIARY","NO",255,"YES","NO","UNKNOWN",5,"MAY",296,1,-1,0,"UNKNOWN","NO"),
(52,"ENTREPRENEUR","MARRIED","SECONDARY","NO",113,"YES","YES","UNKNOWN",5,"MAY",127,1,-1,0,"UNKNOWN","NO"),
(46,"MANAGEMENT","SINGLE","SECONDARY","NO",-246,"YES","NO","UNKNOWN",5,"MAY",255,2,-1,0,"UNKNOWN","NO"),
(36,"TECHNICIAN","SINGLE","SECONDARY","NO",265,"YES","YES","UNKNOWN",5,"MAY",348,1,-1,0,"UNKNOWN","NO"),
(57,"TECHNICIAN","MARRIED","SECONDARY","NO",839,"NO","YES","UNKNOWN",5,"MAY",225,1,-1,0,"UNKNOWN","NO"),
(49,"MANAGEMENT","MARRIED","TERTIARY","NO",378,"YES","NO","UNKNOWN",5,"MAY",230,1,-1,0,"UNKNOWN","NO"),
(60,"ADMIN.","MARRIED","SECONDARY","NO",39,"YES","YES","UNKNOWN",5,"MAY",208,1,-1,0,"UNKNOWN","NO"),
(59,"BLUE-COLLAR","MARRIED","SECONDARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",226,1,-1,0,"UNKNOWN","NO"),
(51,"MANAGEMENT","MARRIED","TERTIARY","NO",10635,"YES","NO","UNKNOWN",5,"MAY",336,1,-1,0,"UNKNOWN","NO"),
(57,"TECHNICIAN","DIVORCED","SECONDARY","NO",63,"YES","NO","UNKNOWN",5,"MAY",242,1,-1,0,"UNKNOWN","NO"),
(25,"BLUE-COLLAR","MARRIED","SECONDARY","NO",-7,"YES","NO","UNKNOWN",5,"MAY",365,1,-1,0,"UNKNOWN","NO"),
(53,"TECHNICIAN","MARRIED","SECONDARY","NO",-3,"NO","NO","UNKNOWN",5,"MAY",1666,1,-1,0,"UNKNOWN","NO"),
(36,"ADMIN.","DIVORCED","SECONDARY","NO",506,"YES","NO","UNKNOWN",5,"MAY",577,1,-1,0,"UNKNOWN","NO"),
(37,"ADMIN.","SINGLE","SECONDARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",137,1,-1,0,"UNKNOWN","NO"),
(44,"SERVICES","DIVORCED","SECONDARY","NO",2586,"YES","NO","UNKNOWN",5,"MAY",160,1,-1,0,"UNKNOWN","NO"),
(50,"MANAGEMENT","MARRIED","SECONDARY","NO",49,"YES","NO","UNKNOWN",5,"MAY",180,2,-1,0,"UNKNOWN","NO"),
(60,"BLUE-COLLAR","MARRIED","UNKNOWN","NO",104,"YES","NO","UNKNOWN",5,"MAY",22,1,-1,0,"UNKNOWN","NO"),
(54,"RETIRED","MARRIED","SECONDARY","NO",529,"YES","NO","UNKNOWN",5,"MAY",1492,1,-1,0,"UNKNOWN","NO"),
(58,"RETIRED","MARRIED","UNKNOWN","NO",96,"YES","NO","UNKNOWN",5,"MAY",616,1,-1,0,"UNKNOWN","NO"),
(36,"ADMIN.","SINGLE","PRIMARY","NO",-171,"YES","NO","UNKNOWN",5,"MAY",242,1,-1,0,"UNKNOWN","NO"),
(58,"SELF-EMPLOYED","MARRIED","TERTIARY","NO",-364,"YES","NO","UNKNOWN",5,"MAY",355,1,-1,0,"UNKNOWN","NO"),
(44,"TECHNICIAN","MARRIED","SECONDARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",225,2,-1,0,"UNKNOWN","NO"),
(55,"TECHNICIAN","DIVORCED","SECONDARY","NO",0,"NO","NO","UNKNOWN",5,"MAY",160,1,-1,0,"UNKNOWN","NO"),
(29,"MANAGEMENT","SINGLE","TERTIARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",363,1,-1,0,"UNKNOWN","NO"),
(54,"BLUE-COLLAR","MARRIED","SECONDARY","NO",1291,"YES","NO","UNKNOWN",5,"MAY",266,1,-1,0,"UNKNOWN","NO"),
(48,"MANAGEMENT","DIVORCED","TERTIARY","NO",-244,"YES","NO","UNKNOWN",5,"MAY",253,1,-1,0,"UNKNOWN","NO"),
(32,"MANAGEMENT","MARRIED","TERTIARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",179,1,-1,0,"UNKNOWN","NO"),
(42,"ADMIN.","SINGLE","SECONDARY","NO",-76,"YES","NO","UNKNOWN",5,"MAY",787,1,-1,0,"UNKNOWN","NO"),
(24,"TECHNICIAN","SINGLE","SECONDARY","NO",-103,"YES","YES","UNKNOWN",5,"MAY",145,1,-1,0,"UNKNOWN","NO"),
(38,"ENTREPRENEUR","SINGLE","TERTIARY","NO",243,"NO","YES","UNKNOWN",5,"MAY",174,1,-1,0,"UNKNOWN","NO"),
(38,"MANAGEMENT","SINGLE","TERTIARY","NO",424,"YES","NO","UNKNOWN",5,"MAY",104,1,-1,0,"UNKNOWN","NO"),
(47,"BLUE-COLLAR","MARRIED","UNKNOWN","NO",306,"YES","NO","UNKNOWN",5,"MAY",13,1,-1,0,"UNKNOWN","NO"),
(40,"BLUE-COLLAR","SINGLE","UNKNOWN","NO",24,"YES","NO","UNKNOWN",5,"MAY",185,1,-1,0,"UNKNOWN","NO"),
(46,"SERVICES","MARRIED","PRIMARY","NO",179,"YES","NO","UNKNOWN",5,"MAY",1778,1,-1,0,"UNKNOWN","NO"),
(32,"ADMIN.","MARRIED","TERTIARY","NO",0,"YES","NO","UNKNOWN",5,"MAY",138,1,-1,0,"UNKNOWN","NO"),
(53,"TECHNICIAN","DIVORCED","SECONDARY","NO",989,"YES","NO","UNKNOWN",5,"MAY",812,1,-1,0,"UNKNOWN","NO"),
(57,"BLUE-COLLAR","MARRIED","PRIMARY","NO",249,"YES","NO","UNKNOWN",5,"MAY",164,1,-1,0,"UNKNOWN","NO"),
(33,"SERVICES","MARRIED","SECONDARY","NO",790,"YES","NO","UNKNOWN",5,"MAY",391,1,-1,0,"UNKNOWN","NO"),
(49,"BLUE-COLLAR","MARRIED","UNKNOWN","NO",154,"YES","NO","UNKNOWN",5,"MAY",357,1,-1,0,"UNKNOWN","NO"),
(51,"MANAGEMENT","MARRIED","TERTIARY","NO",6530,"YES","NO","UNKNOWN",5,"MAY",91,1,-1,0,"UNKNOWN","NO"),
(60,"RETIRED","MARRIED","TERTIARY","NO",100,"NO","NO","UNKNOWN",5,"MAY",528,1,-1,0,"UNKNOWN","NO"),
(59,"MANAGEMENT","DIVORCED","TERTIARY","NO",59,"YES","NO","UNKNOWN",5,"MAY",273,1,-1,0,"UNKNOWN","NO"),
(55,"TECHNICIAN","MARRIED","SECONDARY","NO",1205,"YES","NO","UNKNOWN",5,"MAY",158,2,-1,0,"UNKNOWN","NO"),
(35,"BLUE-COLLAR","SINGLE","SECONDARY","NO",12223,"YES","YES","UNKNOWN",5,"MAY",177,1,-1,0,"UNKNOWN","NO"),
(57,"BLUE-COLLAR","MARRIED","SECONDARY","NO",5935,"YES","YES","UNKNOWN",5,"MAY",258,1,-1,0,"UNKNOWN","NO"),
(31,"SERVICES","MARRIED","SECONDARY","NO",25,"YES","YES","UNKNOWN",5,"MAY",172,1,-1,0,"UNKNOWN","NO"),
(54,"MANAGEMENT","MARRIED","SECONDARY","NO",282,"YES","YES","UNKNOWN",5,"MAY",154,1,-1,0,"UNKNOWN","NO"),
(55,"BLUE-COLLAR","MARRIED","PRIMARY","NO",23,"YES","NO","UNKNOWN",5,"MAY",291,1,-1,0,"UNKNOWN","NO"),
(43,"TECHNICIAN","MARRIED","SECONDARY","NO",1937,"YES","NO","UNKNOWN",5,"MAY",181,1,-1,0,"UNKNOWN","NO"),
(53,"TECHNICIAN","MARRIED","SECONDARY","NO",384,"YES","NO","UNKNOWN",5,"MAY",176,1,-1,0,"UNKNOWN","NO"),
(44,"BLUE-COLLAR","MARRIED","SECONDARY","NO",582,"NO","YES","UNKNOWN",5,"MAY",211,1,-1,0,"UNKNOWN","NO"),
(55,"SERVICES","DIVORCED","SECONDARY","NO",91,"NO","NO","UNKNOWN",5,"MAY",349,1,-1,0,"UNKNOWN","NO"),
(49,"SERVICES","DIVORCED","SECONDARY","NO",0,"YES","YES","UNKNOWN",5,"MAY",272,1,-1,0,"UNKNOWN","NO"),
(55,"SERVICES","DIVORCED","SECONDARY","YES",1,"YES","NO","UNKNOWN",5,"MAY",208,1,-1,0,"UNKNOWN","NO"),
(45,"ADMIN.","SINGLE","SECONDARY","NO",206,"YES","NO","UNKNOWN",5,"MAY",193,1,-1,0,"UNKNOWN","NO"),
(47,"SERVICES","DIVORCED","SECONDARY","NO",164,"NO","NO","UNKNOWN",5,"MAY",212,1,-1,0,"UNKNOWN","NO"),
(42,"TECHNICIAN","SINGLE","SECONDARY","NO",690,"YES","NO","UNKNOWN",5,"MAY",20,1,-1,0,"UNKNOWN","NO"),
(59,"ADMIN.","MARRIED","SECONDARY","NO",2343,"YES","NO","UNKNOWN",5,"MAY",1042,1,-1,0,"UNKNOWN","YES"),
(46,"SELF-EMPLOYED","MARRIED","TERTIARY","NO",137,"YES","YES","UNKNOWN",5,"MAY",246,1,-1,0,"UNKNOWN","NO"),
(51,"BLUE-COLLAR","MARRIED","PRIMARY","NO",173,"YES","NO","UNKNOWN",5,"MAY",529,2,-1,0,"UNKNOWN","NO"),
(56,"ADMIN.","MARRIED","SECONDARY","NO",45,"NO","NO","UNKNOWN",5,"MAY",1467,1,-1,0,"UNKNOWN","YES"),
(41,"TECHNICIAN","MARRIED","SECONDARY","NO",1270,"YES","NO","UNKNOWN",5,"MAY",1389,1,-1,0,"UNKNOWN","YES"),
(46,"MANAGEMENT","DIVORCED","SECONDARY","NO",16,"YES","YES","UNKNOWN",5,"MAY",188,2,-1,0,"UNKNOWN","NO"),
(57,"RETIRED","MARRIED","SECONDARY","NO",486,"YES","NO","UNKNOWN",5,"MAY",180,2,-1,0,"UNKNOWN","NO"),
(42,"MANAGEMENT","SINGLE","SECONDARY","NO",50,"NO","NO","UNKNOWN",5,"MAY",48,1,-1,0,"UNKNOWN","NO"),
(30,"TECHNICIAN","MARRIED","SECONDARY","NO",152,"YES","YES","UNKNOWN",5,"MAY",213,2,-1,0,"UNKNOWN","NO"),
(60,"ADMIN.","MARRIED","SECONDARY","NO",290,"YES","NO","UNKNOWN",5,"MAY",583,1,-1,0,"UNKNOWN","NO");
SELECT * FROM BANK_DETAILS;
SELECT DISTINCT(MARITAL) FROM BANK_DETAILS;
SELECT AGE,JOB FROM BANK_DETAILS WHERE AGE = (SELECT MAX(AGE) FROM BANK_DETAILS);  
SELECT AGE,JOB FROM BANK_DETAILS WHERE BALANCE = (SELECT MAX(BALANCE) FROM BANK_DETAILS);

/* DELIMITER FOR MAX*/
DELIMITER $$
CREATE PROCEDURE MAXIMUM1()
BEGIN 
SELECT MAX(BALANCE)
FROM BANK_DETAILS;
END$$
DELIMITER ;
CALL MAXIMUM1();

/* DELIMITER FOR AVRAGE*/
DELIMITER $$
CREATE PROCEDURE AVG2()
BEGIN 
SELECT AVG(BALANCE)
FROM BANK_DETAILS;
END$$
DELIMITER ;

CALL AVG2();

/* DELIMITER FOR MINIMUM*/
DELIMITER $$
CREATE PROCEDURE MIN2()
BEGIN 
SELECT MIN(BALANCE)
FROM BANK_DETAILS;
END$$
DELIMITER ;

CALL MIN2();

/* CREATE VIEW TABLE*/
CREATE VIEW CUST AS
SELECT AGE,BALANCE,MARITAL
FROM BANK_DETAILS;

SELECT * FROM CUST;
SELECT * FROM CUST WHERE BALANCE=(SELECT MAX(BALANCE) FROM CUST);